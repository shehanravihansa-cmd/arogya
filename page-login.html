<!DOCTYPE html>
<html lang="en-US">

<head>
    <title>Log In</title>
    <meta name="author" content="Nile-Theme">
    <meta name="robots" content="index follow">
    <meta name="googlebot" content="index follow">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="keywords" content="directory, doctor, doctor directory, Health directory, listing, map, medical, medical directory, professional directory, reservation, reviews">
    <meta name="description" content="Health Care & Medical Services Directory">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,800%7CPoppins:300i,300,400,700,400i,500%7CDancing+Script:700%7CDancing+Script:700" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/animate.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/owl.carousel.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/owl.theme.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/hover-min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/flag-icon.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/colors/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elegant_icon.css') }}">

    <!-- jQuery Library -->
    <script src="{{ url_for('static', filename='js/jquery-3.2.1.min.js') }}"></script>
    <!-- FontAwesome -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

</head>

<body>

    <!-- Header -->
    <header>
        <div id="fixed-header-dark" class="header-output fixed-header">
            <div class="container header-in">
                <div class="row">
                    <div class="col-lg-2 col-md-12">
                        <a id="logo" href="{{ url_for('index') }}" class="d-inline-block margin-tb-15px">
                            <img src="{{ url_for('static', filename='img/logo-1.png') }}" alt="">
                        </a>
                        <a class="mobile-toggle padding-13px background-main-color" href="#"><i class="fas fa-bars"></i></a>
                    </div>
                    <!-- Navigation Menu -->
                    <div class="col-lg-7 col-md-12 position-inherit">
                        <ul id="menu-main" class="nav-menu float-lg-right link-padding-tb-20px">
                            <li><a href="{{ url_for('index') }}">Home</a></li>
                            <li class="has-dropdown"><a href="#">Listings</a>
                                <ul class="sub-menu">
                                    <li><a href="{{ url_for('map_grid_layout') }}">Clinics</a></li>
                                    <li><a href="{{ url_for('doctor_layout') }}">Doctors</a></li>
                                </ul>
                            </li>
                            <li><a href="{{ url_for('page_pricing_tables') }}">Packages</a></li>
                            <li class="has-dropdown"><a href="#">Dashboard</a>
                                <ul class="sub-menu">
                                    <li><a href="{{ url_for('dashboard_home') }}">Dashboard Home</a></li>
                                    <li><a href="{{ url_for('dashboard_my_listings') }}">My Listings</a></li>
                                    <li><a href="{{ url_for('dashboard_my_favorites') }}">My Favorites</a></li>
                                    <li><a href="{{ url_for('dashboard_reviews') }}">Reviews</a></li>
                                    <li><a href="{{ url_for('dashboard_bookings') }}">Bookings</a></li>
                                    <li><a href="{{ url_for('dashboard_add_listing') }}">Add Listing</a></li>
                                    <li><a href="{{ url_for('security_dashboard') }}">Security Dashboard</a></li>
                                </ul>
                            </li>
                            <li><a href="{{ url_for('blog') }}">Blog Articles</a></li>
                            <li><a href="{{ url_for('page_about') }}">About Us</a></li>
                            <li><a href="{{ url_for('page_contact_us') }}">Contact Us</a></li>
                        </ul>
                    </div>
                    <!-- Action Buttons -->
                    <div class="col-lg-3 col-md-12">
                        <hr class="margin-bottom-0px d-block d-sm-none">
                        <!-- No buttons needed on login page -->
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="page-title" class="padding-tb-50px gradient-white">
        <div class="container text-center">
            <ol class="breadcrumb opacity-5">
                <li><a href="{{ url_for('index') }}">Home</a></li>
                <li class="active">Login</li>
            </ol>
            <h1 class="font-weight-300 margin-top-30px">Login Page</h1>
        </div>
    </div>

    <div class="container margin-bottom-100px">
    <div id="log-in" class="site-form log-in-form box-shadow border-radius-10">
        
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="alert alert-{{ category }}">{{ message }}</div>
          {% endfor %}
        {% endif %}
    {% endwith %}
      

        <div class="form-output">
            <form method="POST" action="{{ url_for('login') }}">
                <input type="hidden" name="csrf_token" value="{{ session.get('csrf_token', '') }}">

                <!-- Email -->
                <div class="form-group label-floating">
                    <label class="control-label">Your Email</label>
                    <input class="form-control" name="email" placeholder="" type="email" required>
                </div>
    
                <!-- Password -->
                <div class="form-group label-floating">
                    <label class="control-label">Your Password</label>
                    <input class="form-control" name="password" placeholder="" type="password" required>
                </div>
    
                <!-- Remember Me -->
                <div class="remember">
                    <div class="checkbox">
                        <label>
                            <input name="optionsCheckboxes" type="checkbox">
                            Remember Me
                        </label>
                    </div>
                    <a href="#" class="forgot">Forgot Password ?</a>
                </div>
    
                <button type="submit" class="btn btn-md btn-primary full-width">Sign In !</button>
    
                <div class="or"></div>
    
                <a href="#" class="btn btn-md bg-facebook full-width btn-icon-left"><i class="fab fa-facebook margin-right-8px" aria-hidden="true"></i> Login with Facebook</a>
    
                <a href="#" class="btn btn-md bg-twitter full-width btn-icon-left"><i class="fab fa-twitter margin-right-8px" aria-hidden="true"></i> Login with Twitter</a>
    
                <p>Don't have an account? <a href="{{ url_for('signup') }}">Register Now!</a></p>
                <p><a href="{{ url_for('resend_signup_verification') }}" style="color: #667eea;">Didn't receive verification email?</a></p>
                <p>Note: After logging in, you will need to enter a code from your Google Authenticator app.</p>

            </form>
        </div>
    </div>
    </div>

    <footer class="padding-tb-100px background-main-color">
        <div class="container">
            <div class="row">
                <div class="col-lg-2">
                    <a class="d-inline-block margin-tb-15px"><img src="assets/img/logo-2.png" alt=""></a>
                </div>
                <div class="col-lg-4">
                    <p class="text-white opacity-7">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s</p>
                </div>
                <div class="col-lg-6">
                    <ul class="footer-menu margin-tb-15px margin-lr-0px padding-0px list-unstyled float-lg-right">
                        <li><a href="#" class="text-white">Featured</a></li>
                        <li><a href="#" class="text-white">Feedback</a></li>
                        <li><a href="#" class="text-white">Ask a Question</a></li>
                        <li><a href="#" class="text-white">Team</a></li>
                    </ul>
                </div>
            </div>
            <hr class="border-white opacity-4 margin-tb-45px">
            <div class="row">
                <div class="col-lg-6">
                    <p class="margin-0px text-white opacity-7 sm-mb-15px">Â© 2018 tabib Health Directory | All Right Reserved. </p>
                </div>
                <div class="col-lg-6">
                    <ul class="social-icon style-2 float-lg-right">
                        <li class="list-inline-item"><a class="facebook" href="#"><i class="fab fa-facebook-f"></i></a></li>
                        <li class="list-inline-item"><a class="youtube" href="#"><i class="fab fa-youtube"></i></a></li>
                        <li class="list-inline-item"><a class="linkedin" href="#"><i class="fab fa-linkedin"></i></a></li>
                        <li class="list-inline-item"><a class="google" href="#"><i class="fab fa-google-plus"></i></a></li>
                        <li class="list-inline-item"><a class="twitter" href="#"><i class="fab fa-twitter"></i></a></li>
                        <li class="list-inline-item"><a class="rss" href="#"><i class="fa fa-rss" aria-hidden="true"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript Files -->
    <script src="{{ url_for('static', filename='js/sticky-sidebar.js') }}"></script>
    <script src="{{ url_for('static', filename='js/YouTubePopUp.jquery.js') }}"></script>
    <script src="{{ url_for('static', filename='js/owl.carousel.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/imagesloaded.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/wow.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/custom.js') }}"></script>
    <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/ua-parser-js@1/dist/ua-parser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/9.0.0/uuidv4.min.js"></script>
    <script>
      function getCookie(name) {
        let match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
        if (match) return match[2];
        return null;
      }
      function setCookie(name, value, days) {
        let expires = '';
        if (days) {
          let date = new Date();
          date.setTime(date.getTime() + (days*24*60*60*1000));
          expires = '; expires=' + date.toUTCString();
        }
        document.cookie = name + '=' + value + expires + '; path=/';
      }
      
      // Generate a consistent device fingerprint based on device characteristics
      function generateDeviceFingerprint() {
        var parser = new UAParser();
        var device = parser.getDevice();
        var os = parser.getOS();
        var browser = parser.getBrowser();
        
        // Collect device characteristics
        var fingerprint = [
          navigator.userAgent,
          navigator.language,
          screen.width + 'x' + screen.height,
          new Date().getTimezoneOffset(),
          navigator.platform,
          os.name + os.version,
          browser.name + browser.version
        ].join('|');
        
        // Create a hash of the fingerprint for consistency
        var hash = 0;
        for (var i = 0; i < fingerprint.length; i++) {
          var char = fingerprint.charCodeAt(i);
          hash = ((hash << 5) - hash) + char;
          hash = hash & hash; // Convert to 32-bit integer
        }
        
        return 'fp_' + Math.abs(hash).toString(36);
      }
      
      document.addEventListener('DOMContentLoaded', function() {
        // Use consistent device fingerprint instead of random UUID
        let deviceFingerprint = generateDeviceFingerprint();
        
        // Set device_fingerprint hidden field
        let input = document.querySelector('input[name="device_fingerprint"]') || document.createElement('input');
        input.type = 'hidden';
        input.name = 'device_fingerprint';
        input.value = deviceFingerprint;
        if (!document.querySelector('input[name="device_fingerprint"]')) {
          document.forms[0].appendChild(input);
        }
        
        // Device name using UAParser.js
        var parser = new UAParser();
        var device = parser.getDevice();
        var os = parser.getOS();
        var browser = parser.getBrowser();
        let deviceName = '';
        if (device.vendor || device.model) {
          deviceName = (device.vendor ? device.vendor + ' ' : '') + (device.model ? device.model : '');
        } else {
          deviceName = os.name + ' ' + os.version;
        }
        deviceName += ' - ' + browser.name + ' ' + browser.version;
        let nameInput = document.querySelector('input[name="device_name"]') || document.createElement('input');
        nameInput.type = 'hidden';
        nameInput.name = 'device_name';
        nameInput.value = deviceName;
        if (!document.querySelector('input[name="device_name"]')) {
          document.forms[0].appendChild(nameInput);
        }
        
        // Geolocation using ipapi.co
        fetch('https://ipapi.co/json/')
          .then(response => response.json())
          .then(data => {
            let locationInput = document.querySelector('input[name="location"]') || document.createElement('input');
            locationInput.type = 'hidden';
            locationInput.name = 'location';
            locationInput.value = data.city + ', ' + data.country_name;
            if (!document.querySelector('input[name="location"]')) {
              document.forms[0].appendChild(locationInput);
            }
          });
      });
    </script>

</body>

</html>
